# Fail2Ban filter for Angie bad requests (HTTP 400)
# Блокирует сканеров, отправляющих некорректные HTTP запросы

[INCLUDES]

[Definition]

# Паттерн для JSON логов Angie
# Ищем HTTP 400 (Bad Request) - пустые/некорректные запросы
failregex = ^.*"client_ip":"<HOST>".*"response_status":"400".*$

# Игнорируем легитимные 400 (например, слишком большой request)
ignoreregex =

# Описание
datepattern = ^"timestamp":"%%Y-%%m-%%dT%%H:%%M:%%S
